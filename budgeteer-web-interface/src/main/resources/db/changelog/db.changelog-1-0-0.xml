<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
                   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                   xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.3.xsd">

    <changeSet author="ehhc" id="initial-database-setup-1">
        <!-- Take care that the initial-setup is marked as ran if the budget-table already exsists -->
        <preConditions onFail="MARK_RAN">
            <not><tableExists tableName="BUDGET"/></not>
        </preConditions>

        <createTable tableName="BUDGET">
            <column autoIncrement="true" name="ID" type="BIGINT">
                <constraints primaryKey="true" primaryKeyName="SYS_PK_10112"/>
            </column>
            <column name="IMPORT_KEY" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="NAME" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="TOTAL" type="BIGINT"/>
            <column name="PROJECT_ID" type="BIGINT">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <createTable tableName="BUDGETEER_USER">
            <column autoIncrement="true" name="ID" type="BIGINT">
                <constraints primaryKey="true" primaryKeyName="SYS_PK_10121"/>
            </column>
            <column name="NAME" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="PASSWORD" type="VARCHAR(512)">
                <constraints nullable="false"/>
            </column>
            <column name="DEFAULT_PROJECT_ID" type="BIGINT"/>
        </createTable>
        <createTable tableName="BUDGET_TAG">
            <column autoIncrement="true" name="ID" type="BIGINT">
                <constraints primaryKey="true" primaryKeyName="SYS_PK_10117"/>
            </column>
            <column name="TAG" type="VARCHAR(255)"/>
            <column name="BUDGET_ID" type="BIGINT"/>
        </createTable>
        <createTable tableName="DAILY_RATE">
            <column autoIncrement="true" name="ID" type="BIGINT">
                <constraints primaryKey="true" primaryKeyName="SYS_PK_10127"/>
            </column>
            <column name="DATE_END" type="date"/>
            <column name="DATE_START" type="date"/>
            <column name="RATE" type="BIGINT"/>
            <column name="BUDGET_ID" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="PERSON_ID" type="BIGINT">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <createTable tableName="IMPORT">
            <column autoIncrement="true" name="ID" type="BIGINT">
                <constraints primaryKey="true" primaryKeyName="SYS_PK_10132"/>
            </column>
            <column name="END_DATE" type="TIMESTAMP"/>
            <column name="IMPORT_DATE" type="TIMESTAMP"/>
            <column name="IMPORT_TYPE" type="VARCHAR(255)"/>
            <column name="START_DATE" type="TIMESTAMP"/>
            <column name="PROJECT_ID" type="BIGINT">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <createTable tableName="PERSON">
            <column autoIncrement="true" name="ID" type="BIGINT">
                <constraints primaryKey="true" primaryKeyName="SYS_PK_10138"/>
            </column>
            <column name="IMPORT_KEY" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="NAME" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="PROJECT_ID" type="BIGINT">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <createTable tableName="PLAN_RECORD">
            <column autoIncrement="true" name="ID" type="BIGINT">
                <constraints primaryKey="true" primaryKeyName="SYS_PK_10153"/>
            </column>
            <column name="DAILY_RATE" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="RECORD_DATE" type="date">
                <constraints nullable="false"/>
            </column>
            <column name="RECORD_DAY" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="MINUTES" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="RECORD_MONTH" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="RECORD_WEEK" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="RECORD_YEAR" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="BUDGET_ID" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="IMPORT_ID" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="PERSON_ID" type="BIGINT">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <createTable tableName="PROJECT">
            <column autoIncrement="true" name="ID" type="BIGINT">
                <constraints primaryKey="true" primaryKeyName="SYS_PK_10166"/>
            </column>
            <column name="NAME" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="PROJECT_END" type="date"/>
            <column name="PROJECT_START" type="date"/>
        </createTable>
        <createTable tableName="PROJECT_USER">
            <column name="PROJECT_ID" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="USER_ID" type="BIGINT">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <createTable tableName="WORK_RECORD">
            <column autoIncrement="true" name="ID" type="BIGINT">
                <constraints primaryKey="true" primaryKeyName="SYS_PK_10184"/>
            </column>
            <column name="DAILY_RATE" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="RECORD_DATE" type="date">
                <constraints nullable="false"/>
            </column>
            <column name="RECORD_DAY" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="MINUTES" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="RECORD_MONTH" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="RECORD_WEEK" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="RECORD_YEAR" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="BUDGET_ID" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="IMPORT_ID" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="PERSON_ID" type="BIGINT">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <addUniqueConstraint columnNames="PROJECT_ID, IMPORT_KEY" constraintName="UNIQUE_IMPORT_KEY_PER_PROJECT" deferrable="false" disabled="false" initiallyDeferred="false" tableName="BUDGET"/>
        <addUniqueConstraint columnNames="NAME" constraintName="UNIQUE_PROJECT_NAME" deferrable="false" disabled="false" initiallyDeferred="false" tableName="PROJECT"/>
        <addUniqueConstraint columnNames="NAME" constraintName="UNIQUE_USER_NAME" deferrable="false" disabled="false" initiallyDeferred="false" tableName="BUDGETEER_USER"/>
        <addForeignKeyConstraint baseColumnNames="BUDGET_ID" baseTableName="DAILY_RATE" constraintName="FK_3V8J4MA8BH5ITGRHBLI5ULHFR" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="ID" referencedTableName="BUDGET"/>
        <addForeignKeyConstraint baseColumnNames="IMPORT_ID" baseTableName="PLAN_RECORD" constraintName="FK_5YMDTXUR1GFFRW57DQ0FFGJEJ" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="ID" referencedTableName="IMPORT"/>
        <addForeignKeyConstraint baseColumnNames="PROJECT_ID" baseTableName="IMPORT" constraintName="FK_8529O8J1EP65J2X0GA8QDH42S" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="ID" referencedTableName="PROJECT"/>
        <addForeignKeyConstraint baseColumnNames="PERSON_ID" baseTableName="WORK_RECORD" constraintName="FK_9C1F5N7V4YEP3DESF4KYNJ7FB" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="ID" referencedTableName="PERSON"/>
        <addForeignKeyConstraint baseColumnNames="PERSON_ID" baseTableName="DAILY_RATE" constraintName="FK_9KFH3H38BM60I8MNXTYIUE2VM" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="ID" referencedTableName="PERSON"/>
        <addForeignKeyConstraint baseColumnNames="USER_ID" baseTableName="PROJECT_USER" constraintName="FK_D6KFRXUQKNBXRLXHWMN66A3KG" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="ID" referencedTableName="BUDGETEER_USER"/>
        <addForeignKeyConstraint baseColumnNames="PROJECT_ID" baseTableName="BUDGET" constraintName="FK_EVET04KS1DCMO5UA0HN1VPT4X" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="ID" referencedTableName="PROJECT"/>
        <addForeignKeyConstraint baseColumnNames="PROJECT_ID" baseTableName="PERSON" constraintName="FK_II5YXUXQQSAHFEPMOC03XUWF5" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="ID" referencedTableName="PROJECT"/>
        <addForeignKeyConstraint baseColumnNames="PERSON_ID" baseTableName="PLAN_RECORD" constraintName="FK_L1DADG58WQ3H1ESV1DGEAN79J" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="ID" referencedTableName="PERSON"/>
        <addForeignKeyConstraint baseColumnNames="DEFAULT_PROJECT_ID" baseTableName="BUDGETEER_USER" constraintName="FK_MAJUV7T9YPOFKN8Q2EGHKY69R" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="ID" referencedTableName="PROJECT"/>
        <addForeignKeyConstraint baseColumnNames="BUDGET_ID" baseTableName="PLAN_RECORD" constraintName="FK_OF5SC7KP08XNBA2VAIA5G85GO" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="ID" referencedTableName="BUDGET"/>
        <addForeignKeyConstraint baseColumnNames="BUDGET_ID" baseTableName="WORK_RECORD" constraintName="FK_OI9LVDD0W52I4QUB5I345K70P" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="ID" referencedTableName="BUDGET"/>
        <addForeignKeyConstraint baseColumnNames="PROJECT_ID" baseTableName="PROJECT_USER" constraintName="FK_PTWHMSH2VOCLN8SFFHYVR2OHM" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="ID" referencedTableName="PROJECT"/>
        <addForeignKeyConstraint baseColumnNames="IMPORT_ID" baseTableName="WORK_RECORD" constraintName="FK_SWB097IMF5N5M4JSL7UDBGB4S" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="ID" referencedTableName="IMPORT"/>
        <addForeignKeyConstraint baseColumnNames="BUDGET_ID" baseTableName="BUDGET_TAG" constraintName="FK_TJY3WQQ36J8D18B21W09L3F6U" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="ID" referencedTableName="BUDGET"/>
        <createIndex indexName="BUDGET_TAG_BUDGET_ID_IDX" tableName="BUDGET_TAG" unique="false">
            <column name="BUDGET_ID"/>
        </createIndex>
        <createIndex indexName="IMPORT_PROJECT_ID_IDX" tableName="IMPORT" unique="false">
            <column name="PROJECT_ID"/>
        </createIndex>
        <createIndex indexName="PERSON_PROJECT_ID_IDX" tableName="PERSON" unique="false">
            <column name="PROJECT_ID"/>
        </createIndex>
        <createIndex indexName="PLAN_RECORD_BUDGET_ID_IDX" tableName="PLAN_RECORD" unique="false">
            <column name="BUDGET_ID"/>
        </createIndex>
        <createIndex indexName="SYS_IDX_10205" tableName="BUDGET" unique="false">
            <column name="PROJECT_ID"/>
        </createIndex>
        <createIndex indexName="SYS_IDX_10212" tableName="BUDGETEER_USER" unique="false">
            <column name="DEFAULT_PROJECT_ID"/>
        </createIndex>
        <createIndex indexName="SYS_IDX_10216" tableName="DAILY_RATE" unique="false">
            <column name="BUDGET_ID"/>
        </createIndex>
        <createIndex indexName="SYS_IDX_10220" tableName="DAILY_RATE" unique="false">
            <column name="PERSON_ID"/>
        </createIndex>
        <createIndex indexName="SYS_IDX_10244" tableName="PLAN_RECORD" unique="false">
            <column name="IMPORT_ID"/>
        </createIndex>
        <createIndex indexName="SYS_IDX_10256" tableName="PLAN_RECORD" unique="false">
            <column name="PERSON_ID"/>
        </createIndex>
        <createIndex indexName="SYS_IDX_10268" tableName="PROJECT_USER" unique="false">
            <column name="USER_ID"/>
        </createIndex>
        <createIndex indexName="SYS_IDX_10272" tableName="PROJECT_USER" unique="false">
            <column name="PROJECT_ID"/>
        </createIndex>
        <createIndex indexName="SYS_IDX_10288" tableName="WORK_RECORD" unique="false">
            <column name="IMPORT_ID"/>
        </createIndex>
        <createIndex indexName="SYS_IDX_10300" tableName="WORK_RECORD" unique="false">
            <column name="PERSON_ID"/>
        </createIndex>
        <createIndex indexName="WORK_RECORD_BUDGET_ID_IDX" tableName="WORK_RECORD" unique="false">
            <column name="BUDGET_ID"/>
        </createIndex>
    </changeSet>
</databaseChangeLog>
